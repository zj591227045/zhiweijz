# 预算执行分析页面开发提示词

我需要开发当前项目的"预算执行分析"页面，使用Next.js 14框架和现代React技术栈实现。请参考预览HTML文件 `/Users/jackson/Documents/VSCode/zhiweijz/docs/ui_preview/预算执行分析页/index.html` 中的元素、布局和风格来实现页面。

## 技术栈要求

- 核心框架: Next.js 14 (App Router)
- 状态管理: Zustand
- UI组件: shadcn/ui + Tailwind CSS
- 图表库: Chart.js + react-chartjs-2
- HTTP请求: Axios + React Query
- 工具库:
  - dayjs (日期处理)
  - lucide-react (图标)
  - clsx/tailwind-merge (类名合并)

## 页面功能说明

这是一个移动端预算执行分析页面，具有以下核心功能：

1. 预算周期选择（当月、上月、自定义）
2. 预算执行概览
3. 预算执行历史图表
4. 预算调整建议
5. 预算执行详情列表

## UI设计详细说明

页面包含以下UI元素：

### 顶部导航栏：
- 返回按钮
- 居中标题"预算执行分析"
- 周期选择器

### 预算执行概览：
- 总预算执行率卡片：
  - 总预算金额
  - 已使用金额和百分比
  - 环形进度条显示整体执行率
  - 剩余天数提示
- 执行状态摘要：
  - 超支预算数量
  - 接近超支预算数量
  - 使用率低的预算数量

### 预算执行历史图表：
- 柱状图显示历史周期预算执行率
- 每个柱子显示预算金额和实际支出
- 超支部分特殊颜色标记
- 图表交互（点击查看具体周期详情）

### 预算调整建议：
- 基于历史数据的预算调整建议卡片
- 每个建议显示：
  - 分类名称和图标
  - 当前预算金额
  - 建议调整金额
  - 调整理由
  - "应用"按钮

### 预算执行详情列表：
- 按分类分组的预算执行列表
- 每个预算显示：
  - 分类图标和名称
  - 预算金额
  - 已使用金额和百分比
  - 进度条（颜色根据执行率变化）
  - 趋势指示（预计是否会超支）

## 交互逻辑

实现以下交互功能：

1. 周期选择：
   - 点击周期选择器显示选项
   - 选择自定义时显示日期范围选择器
   - 切换周期后刷新所有分析数据

2. 历史图表交互：
   - 点击柱状图查看该周期详细数据
   - 支持左右滑动查看更多历史周期
   - 长按显示详细数据对比

3. 预算调整建议：
   - 点击"应用"按钮跳转到编辑预算页面
   - 预填充建议的调整金额
   - 可选择接受或修改建议

4. 详情列表交互：
   - 点击预算项跳转到预算详情页
   - 支持按执行率排序
   - 支持筛选（全部、超支、接近超支、正常）

## 状态管理

使用Zustand创建一个预算分析状态仓库，包含以下状态：

- 当前选中的预算周期
- 预算执行概览数据
- 历史执行数据
- 调整建议数据
- 预算执行详情列表
- 筛选选项
- 排序选项
- 加载状态（各数据模块）

## 数据模型和API集成

获取预算执行分析的API端点为GET /api/statistics/budgets，支持查询参数：

```
{
  "startDate": "2023-05-01",
  "endDate": "2023-05-31",
  "includeHistory": true,
  "historyMonths": 6
}
```

响应数据结构：

```json
{
  "overview": {
    "totalBudget": 5000,
    "totalSpent": 3500,
    "executionRate": 70,
    "daysRemaining": 10,
    "overspentCount": 2,
    "nearLimitCount": 3,
    "underutilizedCount": 1
  },
  "history": [
    {
      "period": "2023-04",
      "totalBudget": 4800,
      "totalSpent": 4500,
      "executionRate": 93.75
    }
  ],
  "recommendations": [
    {
      "categoryId": "category_uuid",
      "categoryName": "餐饮",
      "categoryIcon": "utensils",
      "currentBudget": 1000,
      "recommendedBudget": 1200,
      "reason": "过去3个月平均超支15%",
      "confidence": "high"
    }
  ],
  "details": [
    {
      "budgetId": "budget_uuid",
      "categoryId": "category_uuid",
      "categoryName": "餐饮",
      "categoryIcon": "utensils",
      "amount": 1000,
      "spent": 850,
      "remaining": 150,
      "executionRate": 85,
      "trend": "OVER_BUDGET",
      "projectedEnd": 1100
    }
  ]
}
```

使用React Query处理API请求，包括：
- 使用useQuery获取预算执行分析数据
- 实现数据缓存和重新获取策略

## 组件结构

设计以下组件结构：

- `BudgetAnalysisPage` - 主页面容器
- `BudgetPeriodSelector` - 周期选择器组件
- `BudgetExecutionSummary` - 执行概览组件
  - `CircularProgress` - 环形进度条组件
  - `ExecutionStats` - 执行状态统计组件
- `BudgetHistoryChart` - 历史执行图表组件
  - `BarChart` - 柱状图组件
  - `ChartTooltip` - 图表提示组件
- `BudgetRecommendations` - 调整建议组件
  - `RecommendationCard` - 建议卡片组件
  - `AdjustmentReason` - 调整理由组件
- `BudgetExecutionList` - 预算执行列表
  - `BudgetExecutionItem` - 执行项组件
  - `ExecutionProgressBar` - 执行进度条组件
  - `TrendIndicator` - 趋势指示器组件
- `FilterSortControls` - 筛选排序控件

## 响应式设计

实现移动优先的响应式设计：

- 移动端：
  - 垂直布局，信息分块展示
  - 图表适应屏幕宽度
  - 建议卡片水平滚动
- 平板/桌面端：
  - 多列布局，更多信息并排展示
  - 更大的图表区域
  - 建议卡片网格布局
  - 同时显示更多预算执行项

## 无障碍性

确保页面符合基本无障碍性要求：

- 图表有文本替代说明
- 所有交互元素有合适的aria标签
- 颜色对比度符合WCAG标准
- 支持键盘导航
- 进度条有文本替代说明

## 其他技术要求

- 使用Tailwind CSS实现所有样式
- 使用Chart.js创建响应式图表
- 使用dayjs处理日期和周期计算
- 优化数据加载体验（骨架屏、加载指示器）
- 预算执行率颜色逻辑：
  - <50%: 蓝色
  - 50-80%: 绿色
  - 80-100%: 黄色
  - >100%: 红色

## 附加功能(如时间允许)

- 预算执行预测（基于当前消费趋势）
- 预算调整历史记录
- 预算执行报告生成
- 预算优化建议（基于AI分析）
- 预算执行日历视图（每日消费与预算对比）
