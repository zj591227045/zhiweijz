# 创建/编辑预算页面开发提示词

我需要开发当前项目的"创建/编辑预算"页面，使用Next.js 14框架和现代React技术栈实现。请参考预览HTML文件 `/Users/jackson/Documents/VSCode/zhiweijz/docs/ui_preview/创建编辑预算页/index.html` 中的元素、布局和风格来实现页面。

## 技术栈要求

- 核心框架: Next.js 14 (App Router)
- 状态管理: Zustand
- UI组件: shadcn/ui + Tailwind CSS
- 表单处理: React Hook Form + Zod验证
- HTTP请求: Axios + React Query
- 工具库:
  - dayjs (日期处理)
  - lucide-react (图标)
  - clsx/tailwind-merge (类名合并)

## 页面功能说明

这是一个移动端创建/编辑预算的页面，具有以下核心功能：

1. 创建新预算
2. 编辑现有预算
3. 设置预算周期（月度、自定义）
4. 选择预算分类
5. 设置预算金额
6. 智能预算建议

## UI设计详细说明

页面包含以下UI元素：

### 顶部导航栏：
- 返回按钮
- 居中标题"创建预算"或"编辑预算"
- 保存按钮

### 预算表单：
- 预算周期选择器：
  - 月度选项（当月、下月）
  - 自定义日期范围选项
- 分类选择器：
  - 分类图标和名称
  - 单选列表或网格
- 金额输入区域：
  - 大字体金额输入框
  - 前置货币符号
  - 数字键盘（可选）
- 智能建议区域：
  - 基于历史数据的预算建议
  - 上期预算参考

### 预览卡片：
- 显示设置的预算效果
- 预算周期文本
- 分类图标和名称
- 预算金额

## 交互逻辑

实现以下交互功能：

1. 页面初始化：
   - 创建模式：显示空表单，默认选择当月
   - 编辑模式：加载现有预算数据并填充表单

2. 周期选择：
   - 点击月度选项自动设置对应月份的起止日期
   - 选择自定义时显示日期范围选择器
   - 日期选择后自动计算天数

3. 分类选择：
   - 点击分类项选中
   - 已有预算的分类显示提示
   - 支持搜索/筛选分类

4. 金额输入：
   - 支持直接输入或使用自定义数字键盘
   - 实时格式化金额显示
   - 显示每日平均预算计算

5. 智能建议：
   - 加载历史消费数据生成建议
   - 点击建议金额自动填入
   - 显示上期预算使用情况

6. 表单提交：
   - 验证所有必填字段
   - 显示提交中状态
   - 成功后返回预算列表页
   - 失败显示错误信息

## 状态管理

使用Zustand创建一个预算表单状态仓库，包含以下状态：

- 表单数据（周期、分类、金额）
- 编辑模式标志（新建/编辑）
- 原始预算数据（编辑模式）
- 智能建议数据
- 表单验证状态
- 提交状态（初始/提交中/成功/失败）

## 数据模型和API集成

创建预算的API端点为POST /api/budgets，请求体：

```json
{
  "categoryId": "category_uuid",
  "startDate": "2023-05-01",
  "endDate": "2023-05-31",
  "amount": 1000
}
```

更新预算的API端点为PUT /api/budgets/:id，请求体同上

获取单个预算的API端点为GET /api/budgets/:id

获取预算建议的API端点为GET /api/budgets/suggestions，支持查询参数：

```
{
  "categoryId": "category_uuid",
  "startDate": "2023-05-01",
  "endDate": "2023-05-31"
}
```

获取分类列表的API端点为GET /api/categories，支持查询参数：

```
{
  "type": "EXPENSE"
}
```

使用React Query处理API请求，包括：
- 使用useQuery获取预算详情（编辑模式）
- 使用useQuery获取分类列表
- 使用useQuery获取预算建议
- 使用useMutation处理创建/更新操作

## 组件结构

设计以下组件结构：

- `BudgetFormPage` - 主页面容器
- `BudgetForm` - 预算表单组件
- `PeriodSelector` - 周期选择组件
  - `MonthSelector` - 月份选择组件
  - `DateRangePicker` - 日期范围选择器
- `CategorySelector` - 分类选择组件
  - `CategoryList` - 分类列表组件
  - `CategorySearch` - 分类搜索组件
- `AmountInput` - 金额输入组件
  - `NumberKeyboard` - 数字键盘组件（可选）
- `BudgetSuggestions` - 智能建议组件
  - `SuggestionCard` - 建议卡片组件
  - `PreviousBudget` - 上期预算组件
- `BudgetPreview` - 预算预览组件

## 响应式设计

实现移动优先的响应式设计：

- 移动端：
  - 垂直布局
  - 分类选择器紧凑网格
  - 大字体金额输入
- 平板/桌面端：
  - 双列布局（表单和预览）
  - 分类选择器更大网格
  - 更详细的建议信息

## 无障碍性

确保页面符合基本无障碍性要求：

- 所有表单元素有关联的标签
- 日期选择器支持键盘操作
- 分类选择支持键盘导航
- 表单错误提示清晰且与输入元素关联

## 其他技术要求

- 使用Tailwind CSS实现所有样式
- 使用React Hook Form处理表单状态和验证
- 使用Zod定义验证规则：
  - 分类ID：必填，字符串
  - 开始日期：必填，有效日期
  - 结束日期：必填，有效日期且大于开始日期
  - 金额：必填，数值类型，大于0
- 使用dayjs处理日期和周期计算
- 表单数据的本地存储（防止意外关闭）

## 附加功能(如时间允许)

- 多分类预算创建（一次设置多个分类的预算）
- 预算模板功能
- 重复预算设置（每月自动创建）
- 高级预算建议（基于AI分析）
- 预算调整历史记录
