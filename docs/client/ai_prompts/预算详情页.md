# 预算详情页面开发提示词

我需要开发当前项目的"预算详情"页面，使用Next.js 14框架和现代React技术栈实现。请参考预览HTML文件 `/Users/jackson/Documents/VSCode/zhiweijz/docs/ui_preview/预算详情页/index.html` 中的元素、布局和风格来实现页面。

## 技术栈要求

- 核心框架: Next.js 14 (App Router)
- 状态管理: Zustand
- UI组件: shadcn/ui + Tailwind CSS
- 表单处理: React Hook Form + Zod验证
- HTTP请求: Axios + React Query
- 工具库:
  - dayjs (日期处理)
  - lucide-react (图标)
  - clsx/tailwind-merge (类名合并)
  - Chart.js (图表)

## 页面功能说明

这是一个移动端预算详情页面，具有以下核心功能：

1. 显示预算基本信息和使用情况
2. 预算使用趋势图表
3. 相关交易列表
4. 编辑和删除预算功能
5. 预算调整建议

## UI设计详细说明

页面包含以下UI元素：

### 顶部导航栏：
- 返回按钮
- 居中标题"预算详情"
- 操作菜单（编辑、删除）

### 预算基本信息卡片：
- 分类图标和名称
- 预算周期（日期范围）
- 预算金额
- 已使用金额和百分比
- 剩余金额和天数
- 大型进度条显示使用情况

### 预算趋势图表：
- 每日/每周使用趋势折线图
- 预测线（基于当前使用趋势）
- 预算线（平均分配）
- 图表交互（点击查看具体日期数据）

### 预算分析：
- 日均消费金额
- 与上期预算比较
- 预算调整建议（如适用）

### 相关交易列表：
- 按日期分组的交易记录
- 每个交易显示：
  - 描述
  - 金额
  - 日期/时间
- 查看更多按钮

### 底部操作区：
- 编辑预算按钮
- 删除预算按钮（需确认）

## 交互逻辑

实现以下交互功能：

1. 页面加载：
   - 根据URL参数获取预算ID
   - 加载预算详情数据
   - 加载预算趋势数据
   - 加载相关交易数据
   - 显示加载状态（骨架屏）

2. 图表交互：
   - 点击图表上的点显示具体日期数据
   - 支持缩放和平移查看不同时间范围
   - 切换日/周/月视图

3. 交易列表交互：
   - 点击交易项跳转到交易详情
   - 点击查看更多加载更多交易
   - 支持筛选交易（如按金额排序）

4. 编辑操作：
   - 点击编辑按钮跳转到编辑页面
   - 编辑完成后返回并刷新详情

5. 删除操作：
   - 点击删除按钮显示确认对话框
   - 确认后执行删除并返回列表页
   - 显示操作结果反馈

## 状态管理

使用Zustand创建一个预算详情状态仓库，包含以下状态：

- 预算详情数据
- 预算趋势数据
- 相关交易列表
- 图表视图模式（日/周/月）
- 加载状态（初始加载、刷新）
- 操作状态（编辑中、删除中）
- 确认对话框状态

## 数据模型和API集成

获取预算详情的API端点为GET /api/budgets/:id，响应数据结构：

```json
{
  "id": "uuid",
  "categoryId": "category_uuid",
  "categoryName": "餐饮",
  "categoryIcon": "utensils",
  "startDate": "2023-05-01",
  "endDate": "2023-05-31",
  "amount": 1000,
  "spent": 650,
  "remaining": 350,
  "percentage": 65,
  "daysTotal": 31,
  "daysRemaining": 15,
  "dailyAverage": 43.33,
  "previousBudget": {
    "amount": 900,
    "spent": 850,
    "percentage": 94
  }
}
```

获取预算趋势的API端点为GET /api/budgets/:id/trends，响应数据结构：

```json
{
  "daily": [
    { "date": "2023-05-01", "amount": 50 },
    { "date": "2023-05-02", "amount": 30 }
  ],
  "weekly": [
    { "week": "W1", "amount": 200 },
    { "week": "W2", "amount": 150 }
  ],
  "prediction": {
    "endAmount": 950,
    "isOverBudget": false
  }
}
```

获取相关交易的API端点为GET /api/budgets/:id/transactions，支持分页参数：

```
{
  "page": 1,
  "limit": 10
}
```

删除预算的API端点为DELETE /api/budgets/:id

使用React Query处理API请求，包括：
- 使用useQuery获取预算详情
- 使用useQuery获取预算趋势
- 使用useInfiniteQuery获取相关交易
- 使用useMutation处理删除操作

## 组件结构

设计以下组件结构：

- `BudgetDetailPage` - 主页面容器
- `BudgetHeader` - 预算基本信息组件
  - `BudgetProgress` - 预算进度组件
  - `BudgetSummary` - 预算摘要组件
- `BudgetTrendChart` - 趋势图表组件
  - `ChartViewToggle` - 图表视图切换
  - `ChartTooltip` - 图表提示组件
- `BudgetAnalysis` - 预算分析组件
  - `ComparisonCard` - 与上期比较组件
  - `RecommendationCard` - 调整建议组件
- `RelatedTransactions` - 相关交易列表
  - `TransactionItem` - 交易项组件
  - `LoadMoreButton` - 加载更多按钮
- `ActionButtons` - 底部操作按钮
- `DeleteConfirmDialog` - 删除确认对话框

## 响应式设计

实现移动优先的响应式设计：

- 移动端：
  - 垂直布局，信息分块展示
  - 图表适应屏幕宽度
  - 交易列表紧凑显示
- 平板/桌面端：
  - 多列布局，更多信息并排展示
  - 更大的图表区域
  - 交易列表与图表并排

## 无障碍性

确保页面符合基本无障碍性要求：

- 图表有文本替代说明
- 所有交互元素有合适的aria标签
- 颜色对比度符合WCAG标准
- 支持键盘导航
- 删除操作有明确的确认机制

## 其他技术要求

- 使用Tailwind CSS实现所有样式
- 使用Chart.js创建响应式图表
- 使用dayjs处理日期和周期计算
- 优化数据加载体验（骨架屏、加载指示器）
- 实现错误处理和重试机制

## 附加功能(如时间允许)

- 预算历史记录查看
- 预算调整功能（直接在详情页修改金额）
- 预算分享功能
- 预算复制功能（创建下月相同预算）
- 高级分析（消费模式、异常检测）
