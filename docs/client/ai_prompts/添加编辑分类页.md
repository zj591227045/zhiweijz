# 添加/编辑分类页面开发提示词

我需要开发当前项目的"添加/编辑分类"页面，使用Next.js 14框架和现代React技术栈实现。请参考预览HTML文件 `/Users/jackson/Documents/VSCode/zhiweijz/docs/ui_preview/添加编辑分类页/index.html` 中的元素、布局和风格来实现页面。

## 技术栈要求

- 核心框架: Next.js 14 (App Router)
- 状态管理: Zustand
- UI组件: shadcn/ui + Tailwind CSS
- 表单处理: React Hook Form + Zod验证
- HTTP请求: Axios + React Query
- 工具库:
  - dayjs (日期处理)
  - lucide-react (图标)
  - clsx/tailwind-merge (类名合并)

## 页面功能说明

这是一个移动端添加/编辑分类的页面，具有以下核心功能：

1. 创建新分类（支出或收入）
2. 编辑现有分类信息
3. 选择分类图标和颜色
4. 表单验证和提交

## UI设计详细说明

页面包含以下UI元素：

### 顶部导航栏：
- 返回按钮
- 居中标题"添加分类"或"编辑分类"
- 保存按钮

### 分类表单：
- 分类名称输入框
- 分类类型选择（支出/收入）
- 图标选择器
- 颜色选择器

### 图标选择器：
- 网格布局显示可选图标
- 搜索/筛选功能
- 当前选中图标高亮显示
- 分页或滚动加载更多图标

### 颜色选择器：
- 预设颜色选项
- 自定义颜色输入
- 颜色预览效果

### 预览区域：
- 显示当前设置的分类效果预览
- 实时更新反映用户选择

## 交互逻辑

实现以下交互功能：

1. 页面初始化：
   - 创建模式：显示空表单
   - 编辑模式：加载现有分类数据并填充表单

2. 表单交互：
   - 输入分类名称（实时验证）
   - 选择分类类型（支出/收入）
   - 点击图标在图标选择器中选择
   - 点击颜色在颜色选择器中选择

3. 图标选择：
   - 点击图标选中
   - 搜索/筛选图标
   - 滚动加载更多图标

4. 颜色选择：
   - 点击预设颜色选中
   - 使用颜色选择器自定义颜色

5. 表单提交：
   - 验证所有必填字段
   - 显示提交中状态
   - 成功后返回分类列表页
   - 失败显示错误信息

## 状态管理

使用Zustand创建一个分类表单状态仓库，包含以下状态：

- 表单数据（名称、类型、图标、颜色）
- 编辑模式标志（新建/编辑）
- 原始分类数据（编辑模式）
- 表单验证状态
- 提交状态（初始/提交中/成功/失败）

## 数据模型和API集成

创建分类的API端点为POST /api/categories，请求体：

```json
{
  "name": "餐饮",
  "icon": "utensils",
  "color": "#FF5722",
  "type": "EXPENSE"
}
```

更新分类的API端点为PUT /api/categories/:id，请求体同上

获取单个分类的API端点为GET /api/categories/:id

使用React Query处理API请求，包括：
- 使用useQuery获取分类详情（编辑模式）
- 使用useMutation处理创建/更新操作

## 组件结构

设计以下组件结构：

- `CategoryFormPage` - 主页面容器
- `CategoryForm` - 分类表单组件
  - `NameInput` - 名称输入组件
  - `TypeSelector` - 类型选择组件
- `IconPicker` - 图标选择器组件
  - `IconGrid` - 图标网格组件
  - `IconSearch` - 图标搜索组件
- `ColorPicker` - 颜色选择器组件
  - `PresetColors` - 预设颜色组件
  - `CustomColorInput` - 自定义颜色输入
- `CategoryPreview` - 分类预览组件

## 响应式设计

实现移动优先的响应式设计：

- 移动端：
  - 垂直布局
  - 图标选择器紧凑网格
  - 颜色选择器单行滚动
- 平板/桌面端：
  - 双列布局（表单和预览）
  - 图标选择器更大网格
  - 颜色选择器多行展示

## 无障碍性

确保页面符合基本无障碍性要求：

- 所有表单元素有关联的标签
- 颜色选择支持键盘操作
- 图标选择支持键盘导航
- 表单错误提示清晰且与输入元素关联

## 其他技术要求

- 使用Tailwind CSS实现所有样式
- 使用React Hook Form处理表单状态和验证
- 使用Zod定义验证规则：
  - 名称：必填，最大长度20字符
  - 类型：必填，枚举值"EXPENSE"或"INCOME"
  - 图标：必填，字符串
  - 颜色：必填，有效的颜色值
- 名称唯一性验证（API调用）
- 表单数据的本地存储（防止意外关闭）

## 附加功能(如时间允许)

- 更丰富的图标库（支持多个图标集）
- 高级颜色选择器（透明度、渐变）
- 自定义图标上传
- 分类模板选择
- 撤销/重做操作
