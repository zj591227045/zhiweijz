# 记账记账记录导入模板 - 使用指南

## 📋 模板文件说明

我们为您准备了三种模板文件，您可以根据需要选择使用：

### 1. **记账记录导入模板.xlsx** (推荐)
- **优点**: 包含完整的字段说明、示例数据和标准分类列表
- **特色**: 带有数据验证、格式化和颜色标注
- **适用**: 希望详细了解每个字段含义的用户

### 2. **记账记录导入模板.csv**
- **优点**: 通用格式，任何表格软件都能打开
- **特色**: 包含示例数据和说明信息
- **适用**: 不使用Excel的用户

### 3. **简化版导入模板.csv**
- **优点**: 结构简洁，直接使用
- **特色**: 只包含必要的表头和少量示例
- **适用**: 熟悉导入流程的用户

## 🚀 快速开始

### 步骤1: 下载模板
选择并下载适合您的模板文件：
- Excel用户: `记账记录导入模板.xlsx`
- 其他用户: `记账记录导入模板.csv`

### 步骤2: 准备数据
根据以下字段要求准备您的记账数据：

| 字段 | 必填 | 格式 | 示例 |
|------|------|------|------|
| 日期 | ✅ | YYYY-MM-DD | 2024-01-15 |
| 金额 | ✅ | 数字 | -25.50 或 25.50 |
| 类型 | ✅ | 文本 | 支出/收入 |
| 分类 | ✅ | 文本 | 餐饮/工资 |
| 描述 | ❌ | 文本 | 午餐 |
| 家庭成员 | ❌ | 文本 | 张三 |

### 步骤3: 填写数据
1. **清理示例数据**: 删除模板中的示例数据行
2. **保留表头**: 第一行字段名称必须保留
3. **填写您的数据**: 按照格式要求填写真实的记账记录

### 步骤4: 检查数据
导入前请检查：
- [ ] 日期格式正确（YYYY-MM-DD）
- [ ] 金额为数字格式
- [ ] 类型字段为"收入"或"支出"
- [ ] 分类使用标准分类名称
- [ ] 无空白的必填字段

## 📊 字段详细说明

### 日期字段
**支持的格式**:
- 标准格式: `2024-01-15`
- 斜杠格式: `2024/01/15`
- 中文格式: `2024年1月15日`
- Excel日期格式（自动识别）

**注意事项**:
- 日期不能为空
- 不能是未来日期
- 建议使用标准格式 `YYYY-MM-DD`

### 金额字段
**填写方式**:
- 方式一: 负数表示支出，正数表示收入
  - 支出: `-25.50`
  - 收入: `5000.00`
- 方式二: 都填正数，通过"类型"字段区分
  - 金额: `25.50`
  - 类型: `支出`

**格式要求**:
- 必须是数字格式
- 最多保留2位小数
- 不要包含货币符号（¥、$等）

### 类型字段
**有效值**:
- 中文: `收入`、`支出`
- 英文: `INCOME`、`EXPENSE`
- 大小写不敏感

### 分类字段
**标准支出分类**:
餐饮、购物、日用、交通、运动、娱乐、通讯、服饰、美容、居家、孩子、长辈、社交、旅行、数码、汽车、医疗、还款、保险、学习、办公、维修、利息

**标准收入分类**:
工资、兼职、理财、奖金、提成、其他

**智能匹配**:
- 如果您的分类名称不在标准列表中，系统会自动进行智能匹配
- 例如："吃饭" → "餐饮"，"买菜" → "购物"

### 描述字段 (可选)
- 用于记录记账的详细信息
- 最多200个字符
- 可以为空

### 家庭成员字段 (可选)
- 仅在使用家庭账本时需要填写
- 填写参与该笔记账的家庭成员姓名
- 个人账本可以留空

## 💡 填写技巧

### 1. 批量处理技巧
- **使用公式**: 在Excel中可以使用公式自动计算或转换数据
- **数据筛选**: 利用筛选功能检查特定类型的数据
- **查找替换**: 批量替换分类名称

### 2. 数据清洗技巧
- **去除空格**: 使用`TRIM()`函数去除多余空格
- **统一格式**: 确保同类数据格式一致
- **检查重复**: 避免导入重复的记账记录

### 3. 分类映射技巧
如果您的原始分类与标准分类不同：

| 原始分类 | 建议映射 | 原始分类 | 建议映射 |
|---------|---------|---------|---------|
| 吃饭、用餐 | 餐饮 | 工资收入 | 工资 |
| 买菜、购买 | 购物 | 兼职费 | 兼职 |
| 打车、公交 | 交通 | 投资收益 | 理财 |
| 看电影 | 娱乐 | 年终奖 | 奖金 |

## ⚠️ 常见问题

### Q1: 导入时提示"日期格式错误"
**解决方案**:
1. 确保使用标准格式 `YYYY-MM-DD`
2. 检查是否有空白或特殊字符
3. 在Excel中设置单元格格式为"日期"

### Q2: 金额字段不被识别为数字
**解决方案**:
1. 移除所有非数字字符（除了小数点和负号）
2. 在Excel中设置单元格格式为"数字"
3. 确保使用英文的小数点（.）而不是中文的（。）

### Q3: 分类无法自动匹配
**解决方案**:
1. 优先使用标准分类名称
2. 检查拼写是否正确
3. 在预览时手动选择正确的分类

### Q4: 文件上传失败
**解决方案**:
1. 检查文件大小（不超过10MB）
2. 确保文件格式正确（.xlsx、.xls、.csv）
3. 检查文件是否损坏

### Q5: 部分数据导入失败
**解决方案**:
1. 查看错误报告了解具体问题
2. 修复错误数据后重新导入
3. 正确的数据不会受影响

## 📈 导入流程

1. **准备模板**: 下载并填写模板文件
2. **数据验证**: 检查数据格式和完整性
3. **上传文件**: 在导入页面上传文件
4. **智能匹配**: 系统自动进行分类匹配
5. **预览确认**: 查看并确认导入数据
6. **执行导入**: 开始批量导入记账记录
7. **查看报告**: 查看导入结果和统计信息

## 🎯 最佳实践

### 数据准备
- 按时间顺序整理记账记录
- 统一分类名称的写法
- 为重要记账添加详细描述

### 导入前检查
- 使用Excel的数据验证功能
- 检查是否有重复记录
- 确认金额符号的一致性

### 导入后验证
- 检查导入的记录数量
- 验证金额总计是否正确
- 确认分类分布合理

## 📞 技术支持

如果在使用过程中遇到问题：

1. **查看错误信息**: 系统会提供详细的错误提示
2. **参考文档**: 查看完整的导入说明文档
3. **联系支持**: 如有疑问可联系技术支持团队

---

*祝您使用愉快！如有问题，请随时联系我们。* 