# 只为记账 Docker 部署环境配置
# 版本: 0.7.5
# 复制此文件为 .env 并根据实际部署环境修改配置

# ================================
# 配置说明
# ================================

# 生产环境部署前必须修改的配置项:
# 1. DB_PASSWORD - 数据库密码
# 2. EXTERNAL_DOMAIN - 外部访问域名
# 3. MINIO_ROOT_PASSWORD - MinIO管理员密码
# 4. S3_SECRET_ACCESS_KEY - S3访问密钥

# 可选配置项（根据需要启用）:
# - 微信公众号配置（WECHAT_*）
# - 邮件服务配置（SMTP_*）
# - AI服务配置（OPENAI_API_KEY）

# 日志配置建议:
# - 生产环境建议禁用详细日志（NEXT_PUBLIC_ENABLE_CONSOLE_LOGS=false）
# - 仅保留错误日志（NEXT_PUBLIC_LOG_LEVEL=error）
# - 允许运行时控制用于临时调试（NEXT_PUBLIC_ALLOW_RUNTIME_LOG_CONTROL=true）

# ================================
# 基础配置
# ================================
PROJECT_NAME=zhiweijz
COMPOSE_PROJECT_NAME=zhiweijz

# ================================
# Docker镜像版本
# ================================
BACKEND_IMAGE_VERSION=0.7.5
FRONTEND_IMAGE_VERSION=0.7.5
NGINX_IMAGE_VERSION=0.7.5
POSTGRES_IMAGE_VERSION=15-alpine
MINIO_IMAGE_VERSION=RELEASE.2025-04-08T15-41-24Z-cpuv1


# ================================
# 数据库配置
# ================================
DB_NAME=zhiweijz
DB_USER=zhiweijz
DB_PASSWORD=zhiweijz123
DB_HOST=postgres
# 数据库主机名（Docker内部网络中的服务名）
DB_PORT=5432
# 数据库内部端口（Docker容器间通信使用，固定为5432，不建议修改）
# ================================
# 应用配置
# ================================
JWT_SECRET=your-super-secret-jwt-key-change-in-production-please
NODE_ENV=production
DOCKER_ENV=true

# 外部访问域名配置（包含域名+端口）
# 用于nginx重定向、iOS快捷指令返回地址、token验证地址等
# 示例: https://your-domain.com:443 或 http://your-domain.com:8080
EXTERNAL_DOMAIN=https://your-domain.com

# ================================
# 前端应用配置
# ================================

# 应用版本信息
NEXT_PUBLIC_APP_VERSION=0.7.5
NEXT_PUBLIC_BUILD_NUMBER=75

# 构建模式配置
BUILD_MODE=web
IS_MOBILE_BUILD=false
NEXT_PUBLIC_IS_MOBILE=false

# 官方网站地址
NEXT_PUBLIC_OFFICIAL_WEBSITE=https://www.zhiweijz.cn

# ================================
# 端口配置
# ================================
# PostgreSQL外部访问端口（宿主机映射端口，可自定义避免冲突）
POSTGRES_EXTERNAL_PORT=5432

# 后端API端口
BACKEND_PORT=3000

# 前端Web端口
FRONTEND_PORT=3001

# Nginx端口
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# MinIO端口
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

# ================================
# MinIO对象存储配置
# ================================
MINIO_ROOT_USER=zhiweijz
MINIO_ROOT_PASSWORD=zhiweijz123456
MINIO_BROWSER_REDIRECT_URL=http://minio:9001

# S3配置
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY_ID=zhiweijz
S3_SECRET_ACCESS_KEY=zhiweijz123456
S3_REGION=us-east-1
S3_BUCKET_AVATARS=avatars
S3_BUCKET_ATTACHMENTS=transaction-attachments
S3_BUCKET_TEMP=temp-files
S3_BUCKET_SYSTEM=system-files

# 文件存储配置
FILE_STORAGE_TYPE=s3
FILE_STORAGE_BASE_URL=http://minio:9000
FILE_MAX_SIZE=10485760
FILE_ALLOWED_TYPES=image/jpeg,image/png,image/gif,image/webp,application/pdf

# ================================
# 版本管理配置
# ================================

# 版本更新检查功能开关
NEXT_PUBLIC_ENABLE_VERSION_CHECK=true

# 版本检查间隔 (毫秒)
NEXT_PUBLIC_VERSION_CHECK_INTERVAL=86400000

# 自动检查开关
NEXT_PUBLIC_AUTO_VERSION_CHECK=true

# 版本检查API配置
NEXT_PUBLIC_API_BASE_URL=
NEXT_PUBLIC_DEBUG_API_BASE_URL=
# ================================
# 控制台日志管理配置（生产环境建议）
# ================================

# 是否启用控制台日志（生产环境建议: false）
NEXT_PUBLIC_ENABLE_CONSOLE_LOGS=false

# 日志级别（生产环境建议: error）
NEXT_PUBLIC_LOG_LEVEL=error

# 生产环境是否保留错误日志
NEXT_PUBLIC_PRESERVE_ERROR_LOGS=true

# 是否允许运行时控制日志（用于生产环境临时调试）
NEXT_PUBLIC_ALLOW_RUNTIME_LOG_CONTROL=true

# ================================
# RevenueCat支付配置（仅iOS使用）
# ================================

# RevenueCat iOS SDK API密钥（公开密钥，用于iOS客户端）
# 从 RevenueCat Dashboard → Project Settings → API keys → App specific keys → iOS 获取
# 格式：appl_xxxxxxxxxxxxxxxxx
NEXT_PUBLIC_REVENUECAT_IOS_API_KEY=your_ios_production_sdk_api_key

# 向后兼容的通用API密钥（与iOS密钥相同）
NEXT_PUBLIC_REVENUECAT_API_KEY=your_ios_production_sdk_api_key

# 注意：Android使用单独的第三方支付，不使用RevenueCat
# 注意：Web版本暂不支持支付功能

# ================================
# RevenueCat服务器端配置（仅用于后端）
# ================================

# RevenueCat REST API密钥（私有密钥，用于服务端API调用）
# 从 RevenueCat Dashboard → Project Settings → API keys → Secret API keys 获取
# 格式：sk_xxxxxxxxxxxxxxxxx
# 警告：此密钥绝不能暴露在客户端代码中
REVENUECAT_REST_API_KEY=your_production_rest_api_key

# RevenueCat Webhook密钥（可选，用于验证webhook）
# 从 RevenueCat Dashboard → Integrations → Webhooks 配置时生成
# 注意：生产环境强烈建议配置此密钥以确保webhook安全性
# 配置步骤：1. 在RevenueCat Dashboard创建webhook 2. 复制生成的secret
REVENUECAT_WEBHOOK_SECRET=your_webhook_secret_here

# ================================
# 会员系统配置
# ================================
ENABLE_MEMBERSHIP_SYSTEM=false
ENABLE_ACCOUNTING_POINTS_SYSTEM=false
MEMBERSHIP_MONTHLY_POINTS=1000
DEFAULT_MEMBER_TYPE=REGULAR

# ================================
# 微信公众号配置（可选）
# ================================
WECHAT_APP_ID=
WECHAT_APP_SECRET=
WECHAT_TOKEN=
WECHAT_ENCODING_AES_KEY=
WECHAT_ENV=production

# 开发环境微信配置（可选）
WECHAT_DEV_APP_ID=
WECHAT_DEV_APP_SECRET=
WECHAT_DEV_TOKEN=

# ================================
# 邮件服务配置（可选）
# ================================
SMTP_HOST=
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=

# ================================
# AI服务配置（可选）
# ================================
OPENAI_API_KEY=

# ================================
# 后端版本管理系统配置
# ================================
ENABLE_VERSION_MANAGEMENT=true
VERSION_CHECK_API_ENABLED=true
VERSION_CHECK_INTERVAL=86400
FORCE_UPDATE_GRACE_PERIOD=604800
UPDATE_NOTIFICATION_ENABLED=true

# ================================
# 其他配置
# ================================

# 禁用Next.js遥测
NEXT_TELEMETRY_DISABLED=1


