# Scriptsç›®å½•é‡ç»„æ€»ç»“

## ğŸ“‹ é‡ç»„æ¦‚è¿°

æœ¬æ¬¡é‡ç»„æ¶‰åŠä¸¤ä¸ªä¸»è¦ç›®å½•çš„è„šæœ¬æ•´ç†ï¼š
1. **é¡¹ç›®æ ¹ç›®å½• `/scripts`** - æŒ‰åŠŸèƒ½åˆ†ç±»é‡ç»„
2. **Serverç›®å½• `/server`** - æ¸…ç†è¿‡æ—¶è„šæœ¬ï¼Œå½’æ¡£æœ‰ç”¨è„šæœ¬

## ğŸ¯ é‡ç»„ç›®æ ‡

- **æé«˜å¯ç»´æŠ¤æ€§**: æŒ‰åŠŸèƒ½åˆ†ç±»ï¼Œä¾¿äºæŸ¥æ‰¾å’Œç®¡ç†
- **æ¸…ç†å†—ä½™**: åˆ é™¤è¿‡æ—¶çš„è°ƒè¯•è„šæœ¬
- **æ ‡å‡†åŒ–ç»“æ„**: ç»Ÿä¸€çš„ç›®å½•ç»“æ„å’Œå‘½åè§„èŒƒ
- **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œåˆ†ç±»æŒ‡å—

## ğŸ“ é¡¹ç›®æ ¹ç›®å½• scripts/ é‡ç»„

### æ–°ç›®å½•ç»“æ„
```
scripts/
â”œâ”€â”€ deployment/         # éƒ¨ç½²ç›¸å…³è„šæœ¬ (3ä¸ª)
â”œâ”€â”€ testing/           # æµ‹è¯•è„šæœ¬ (12ä¸ª)
â”œâ”€â”€ development/       # å¼€å‘ç›¸å…³è„šæœ¬ (1ä¸ª)
â”œâ”€â”€ docker/           # Dockerç›¸å…³è„šæœ¬ (3ä¸ª)
â”œâ”€â”€ database/         # æ•°æ®åº“ç›¸å…³è„šæœ¬ (1ä¸ªç›®å½•)
â”œâ”€â”€ monitoring/       # ç›‘æ§ç›¸å…³è„šæœ¬ (é¢„ç•™)
â”œâ”€â”€ utilities/        # å·¥å…·è„šæœ¬ (2ä¸ª)
â””â”€â”€ README.md         # å®Œæ•´çš„ä½¿ç”¨è¯´æ˜
```

### è„šæœ¬åˆ†ç±»è¯¦æƒ…

#### ğŸš€ deployment/ (3ä¸ªè„šæœ¬)
- `release-version.sh` - ç‰ˆæœ¬å‘å¸ƒè„šæœ¬
- `start-backend.sh` - å¯åŠ¨åç«¯æœåŠ¡
- `start-dev-frontend.sh` - å¯åŠ¨å¼€å‘å‰ç«¯

#### ğŸ§ª testing/ (12ä¸ªè„šæœ¬)
- `demo-tests.js` - æ¼”ç¤ºæµ‹è¯•
- `run-full-tests.js` - è¿è¡Œå®Œæ•´æµ‹è¯•
- `test-android-setup.js` - Androidè®¾ç½®æµ‹è¯•
- `test-backend-api.js` - åç«¯APIæµ‹è¯•
- `test-backend-build.sh` - åç«¯æ„å»ºæµ‹è¯•
- `test-e2e.js` - ç«¯åˆ°ç«¯æµ‹è¯•
- `test-environment-guide.js` - ç¯å¢ƒæµ‹è¯•æŒ‡å—
- `test-frontend.js` - å‰ç«¯æµ‹è¯•
- `test-health-check.js` - å¥åº·æ£€æŸ¥æµ‹è¯•
- `test-regression.js` - å›å½’æµ‹è¯•
- `test-config.json` - æµ‹è¯•é…ç½®æ–‡ä»¶
- `regression-config.json` - å›å½’æµ‹è¯•é…ç½®

#### ğŸ› ï¸ development/ (1ä¸ªè„šæœ¬)
- `check-env.sh` - æ£€æŸ¥å¼€å‘ç¯å¢ƒ

#### ğŸ³ docker/ (3ä¸ªè„šæœ¬)
- `fix-docker-mirrors.sh` - ä¿®å¤Dockeré•œåƒæº
- `setup-docker-mirrors.sh` - è®¾ç½®Dockeré•œåƒæº
- `test-mirrors.sh` - æµ‹è¯•é•œåƒæº

#### ğŸ—„ï¸ database/ (1ä¸ªç›®å½•)
- `db_backup/` - æ•°æ®åº“å¤‡ä»½å·¥å…·é›†

#### ğŸ”§ utilities/ (2ä¸ªè„šæœ¬)
- `analyze-server-scripts.js` - åˆ†æserverç›®å½•è„šæœ¬
- `cleanup-server-scripts.sh` - æ¸…ç†serverç›®å½•è„šæœ¬

## ğŸ§¹ Serverç›®å½•æ¸…ç†åˆ†æ

### åˆ†æç»Ÿè®¡
- **æ€»è®¡æ–‡ä»¶**: 46ä¸ª
- **å¯åˆ é™¤**: 21ä¸ªè¿‡æ—¶è°ƒè¯•è„šæœ¬
- **éœ€å½’æ¡£**: 23ä¸ªæœ‰ç”¨è„šæœ¬
- **éœ€ä¿ç•™**: 1ä¸ªé…ç½®æ–‡ä»¶
- **éœ€åˆ¤æ–­**: 1ä¸ªå·¥å…·è„šæœ¬

### åˆ é™¤çš„è¿‡æ—¶è„šæœ¬ (21ä¸ª)
ä¸»è¦æ˜¯è°ƒè¯•å’Œä¸´æ—¶é—®é¢˜æ’æŸ¥è„šæœ¬ï¼š
- `analyze-budget-details.js`
- `check-budget-rollover-amount.js`
- `debug-rollover-difference.js`
- `fix-*-rollover*.js` (å¤šä¸ª)
- `test-*-rollover*.js` (å¤šä¸ª)
- `verify-current-rollover.js`
- ç­‰ç­‰...

### å½’æ¡£çš„æœ‰ç”¨è„šæœ¬ (23ä¸ª)

#### ğŸ“ ç§»åŠ¨åˆ° server/scripts/database/ (7ä¸ª)
- `check-custodial-members.js`
- `cleanup-custodial-users.js`
- `cleanup-duplicate-duoduo.js`
- `create-budget-history-table.js`
- `fix-duplicate-family-accounts.js`
- `list-budgets.js`
- `simple-create-custodial.js`

#### ğŸ§ª ç§»åŠ¨åˆ° server/scripts/testing/ (7ä¸ª)
- `create-test-custodial-user.js`
- `test-invitation-format.js`
- `test-invitation.js`
- `test-active-budgets.js`
- `test-new-rollover-logic.js`
- `test-prisma.js`
- `test-rollover-history.js`

### ä¿ç•™çš„æ–‡ä»¶ (1ä¸ª)
- `jest.config.js` - Jesté…ç½®æ–‡ä»¶

## ğŸ”§ ä½¿ç”¨å·¥å…·

### åˆ†æå·¥å…·
- `scripts/utilities/analyze-server-scripts.js` - è‡ªåŠ¨åˆ†æè„šæœ¬ç”¨é€”å’ŒçŠ¶æ€

### æ¸…ç†å·¥å…·
- `scripts/utilities/cleanup-server-scripts.sh` - è‡ªåŠ¨æ‰§è¡Œæ¸…ç†æ“ä½œ

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### 1. æŸ¥çœ‹é¡¹ç›®æ ¹ç›®å½•è„šæœ¬
```bash
# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨è„šæœ¬
ls scripts/*/

# è¿è¡Œéƒ¨ç½²è„šæœ¬
./scripts/deployment/release-version.sh --minor

# è¿è¡Œæµ‹è¯•è„šæœ¬
node scripts/testing/run-full-tests.js
```

### 2. æŸ¥çœ‹serverç›®å½•è„šæœ¬
```bash
# æŸ¥çœ‹æ•°æ®åº“å·¥å…·
ls server/scripts/database/

# æŸ¥çœ‹æµ‹è¯•è„šæœ¬
ls server/scripts/testing/

# è¿è¡Œæ•°æ®åº“å·¥å…·
node server/scripts/database/check-db.js
```

### 3. æ‰§è¡Œæ¸…ç†æ“ä½œ
```bash
# åˆ†æserverç›®å½•è„šæœ¬
node scripts/utilities/analyze-server-scripts.js

# æ‰§è¡Œæ¸…ç†ï¼ˆè°¨æ…æ“ä½œï¼‰
./scripts/utilities/cleanup-server-scripts.sh
```

## ğŸ›¡ï¸ å®‰å…¨æªæ–½

### å¤‡ä»½æœºåˆ¶
- æ¸…ç†è„šæœ¬ä¼šè‡ªåŠ¨åˆ›å»ºå¤‡ä»½
- å¤‡ä»½ä½ç½®ï¼š`backups/server-scripts-YYYYMMDD_HHMMSS/`
- åŒ…å«æ‰€æœ‰è¢«åˆ é™¤å’Œç§»åŠ¨çš„æ–‡ä»¶

### æ¢å¤æ–¹æ³•
```bash
# ä»å¤‡ä»½æ¢å¤æ–‡ä»¶
cp backups/server-scripts-*/to-delete/filename.js server/
cp backups/server-scripts-*/to-archive/filename.js server/
```

## ğŸ“Š é‡ç»„æ•ˆæœ

### æå‡æ•ˆæœ
- âœ… **ç»“æ„æ¸…æ™°**: æŒ‰åŠŸèƒ½åˆ†ç±»ï¼Œä¸€ç›®äº†ç„¶
- âœ… **æ˜“äºç»´æŠ¤**: æ–°å¢è„šæœ¬æœ‰æ˜ç¡®çš„åˆ†ç±»è§„åˆ™
- âœ… **å‡å°‘å†—ä½™**: åˆ é™¤21ä¸ªè¿‡æ—¶è„šæœ¬
- âœ… **æ–‡æ¡£å®Œå–„**: æ¯ä¸ªç›®å½•éƒ½æœ‰è¯¦ç»†è¯´æ˜
- âœ… **å·¥å…·æ”¯æŒ**: æä¾›è‡ªåŠ¨åŒ–åˆ†æå’Œæ¸…ç†å·¥å…·

### æ•°é‡å¯¹æ¯”
| ç±»å‹ | é‡ç»„å‰ | é‡ç»„å | å˜åŒ– |
|------|--------|--------|------|
| é¡¹ç›®æ ¹ç›®å½•scripts | æ•£ä¹±åˆ†å¸ƒ | 6ä¸ªåˆ†ç±»ç›®å½• | +ç»“æ„åŒ– |
| Serverç›®å½•è„šæœ¬ | 46ä¸ªæ··æ‚ | 25ä¸ªåˆ†ç±» | -21ä¸ªè¿‡æ—¶ |
| æ–‡æ¡£è¯´æ˜ | ç®€å• | è¯¦ç»†å®Œæ•´ | +å¯ç»´æŠ¤æ€§ |

## ğŸ”® åç»­ç»´æŠ¤

### æ–°å¢è„šæœ¬è§„åˆ™
1. **ç¡®å®šç”¨é€”**: æ˜ç¡®è„šæœ¬çš„ä¸»è¦åŠŸèƒ½
2. **é€‰æ‹©ç›®å½•**: æ ¹æ®åŠŸèƒ½é€‰æ‹©åˆé€‚çš„åˆ†ç±»ç›®å½•
3. **æ›´æ–°æ–‡æ¡£**: åœ¨ç›¸åº”çš„READMEä¸­æ·»åŠ è¯´æ˜
4. **è®¾ç½®æƒé™**: shellè„šæœ¬éœ€è¦æ‰§è¡Œæƒé™

### å®šæœŸæ¸…ç†
1. **å­£åº¦æ£€æŸ¥**: æ¯å­£åº¦è¿è¡Œåˆ†æå·¥å…·æ£€æŸ¥
2. **åŠæ—¶æ¸…ç†**: å‘ç°è¿‡æ—¶è„šæœ¬åŠæ—¶åˆ é™¤
3. **æ–‡æ¡£æ›´æ–°**: ä¿æŒæ–‡æ¡£ä¸å®é™…è„šæœ¬åŒæ­¥

## ğŸ‰ æ€»ç»“

é€šè¿‡æœ¬æ¬¡é‡ç»„ï¼Œé¡¹ç›®çš„è„šæœ¬ç®¡ç†è¾¾åˆ°äº†ï¼š
- **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„ç›®å½•ç»“æ„å’Œå‘½åè§„èŒƒ
- **è‡ªåŠ¨åŒ–**: æä¾›å·¥å…·æ”¯æŒåˆ†æå’Œæ¸…ç†
- **æ–‡æ¡£åŒ–**: å®Œæ•´çš„ä½¿ç”¨è¯´æ˜å’Œç»´æŠ¤æŒ‡å—
- **å¯æ‰©å±•**: é¢„ç•™ç›®å½•æ”¯æŒæœªæ¥åŠŸèƒ½æ‰©å±•

è¿™ä¸ºé¡¹ç›®çš„é•¿æœŸç»´æŠ¤å’Œå›¢é˜Ÿåä½œå¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚
