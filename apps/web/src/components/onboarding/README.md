# 首次登录引导功能

## 功能概述

首次登录引导功能为新用户提供了完整的应用介绍和设置流程，帮助用户快速上手使用应用。

## 功能特性

### 触发机制
- ✅ 用户首次登录时自动显示引导流程
- ✅ 用户可在任意步骤点击"跳过"按钮略过整个引导流程
- ✅ 跳过状态保存在本地存储中，重新安装应用或清除数据后会重新出现
- ✅ 在设置界面添加"重新查看引导"选项，允许用户主动重新进入引导流程

### 引导流程设计

#### 第一步：账本类型选择
1. **个人记账路径**：直接进入第二步
2. **家庭记账路径**：
   - 询问"创建家庭"还是"加入家庭"
   - **创建家庭**：
     - 提供输入框让用户输入家庭名称
     - 创建家庭后生成邀请码，提示用户复制邀请码以邀请其他家庭成员
     - 询问是否有孩子、老人等无法自主记账的用户，如果回答"是"，则引导创建托管成员
     - 询问是否切换到家庭账本，点击"是"则切换到家庭账本，然后进入第二步
   - **加入家庭**：
     - 提供邀请码输入框
     - 输入邀请码后直接加入家庭
     - 询问是否切换到家庭账本，点击"是"则切换到家庭账本，然后进入第二步

#### 第二步：预算控制设置
1. 介绍预算控制和结转功能的意义和作用
2. 询问是否开启预算控制功能
3. **选择"否"**：直接进入第三步
4. **选择"是"**：
   - **个人账本**：提供输入框让用户输入个人预算金额
   - **家庭账本**：
     - 如果是家庭管理员：提供界面快速设置所有家庭成员的预算金额
     - 如果不是家庭管理员：只能设置自己的预算金额
5. 点击确认完成预算控制功能启用

#### 第三步：功能介绍
逐步介绍以下核心功能的使用方法：
1. 如何添加记账记录
2. 如何查看统计数据
3. 如何查看预算执行情况

## 技术实现

### 状态管理
- 使用 Zustand 进行状态管理
- 支持持久化存储（localStorage/AsyncStorage）
- 跨平台兼容（Web/iOS/Android）

### 组件结构
```
onboarding/
├── onboarding-modal.tsx          # 主模态框组件
├── onboarding-provider.tsx       # 引导提供者组件
├── skip-confirm-dialog.tsx       # 跳过确认对话框
├── steps/
│   ├── account-type-step.tsx     # 账本类型选择步骤
│   ├── budget-setup-step.tsx     # 预算设置步骤
│   └── feature-intro-step.tsx    # 功能介绍步骤
├── onboarding-modal.css          # 样式文件
└── README.md                     # 说明文档
```

### 样式特性
- ✅ 使用模态框（Modal）实现引导界面，确保用户注意力集中
- ✅ 每个步骤都提供"跳过"按钮，点击后弹出确认提示
- ✅ 确保引导界面在不同平台（Web、iOS、Android）上的一致性体验
- ✅ 支持用户在设置界面重新触发引导流程
- ✅ 提供清晰的进度指示
- ✅ 响应式设计，适配不同屏幕尺寸

## 使用方法

### 1. 自动触发
引导功能会在用户首次登录后自动触发，无需额外配置。

### 2. 手动触发
用户可以在设置页面点击"重新查看引导"来手动触发引导流程。

### 3. 测试
访问 `/test-onboarding` 页面可以测试引导功能的各种状态。

## API 集成

### 家庭相关 API
- `POST /api/families` - 创建家庭
- `POST /api/families/:id/invitations` - 创建邀请
- `POST /api/families/join` - 加入家庭

### 预算相关 API
- `POST /api/budgets` - 创建预算
- `PUT /api/budgets/:id` - 更新预算

## 跨平台支持

### Web
- 使用 localStorage 进行状态持久化
- 支持响应式设计
- iOS/Android 特定样式适配

### 移动端
- 使用 AsyncStorage 进行状态持久化
- 原生导航集成
- 平台特定的安全区域适配

## 开发注意事项

1. **状态持久化**：确保引导状态正确保存和恢复
2. **API 集成**：需要实现相关的后端 API 接口
3. **错误处理**：提供友好的错误提示和重试机制
4. **性能优化**：使用懒加载和代码分割
5. **测试覆盖**：确保各种场景下的功能正常

## 未来扩展

- [ ] 添加动画效果和过渡
- [ ] 支持多语言
- [ ] 添加引导完成后的成就系统
- [ ] 支持自定义引导流程
- [ ] 添加使用统计和分析
